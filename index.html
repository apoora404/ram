<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Sollong 통합 계산기</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    font-family: 'Arial', sans-serif;
    max-width: 600px;
    margin: 30px auto;
    padding: 20px;
    background: linear-gradient(135deg, #0e0e1e, #1a0f2b); /* Sollong DApp 배경 */
    color: #e0e6f0;
    box-sizing: border-box;
  }
  h2 {
    text-align: center;
    color: #8c7eff; /* 메인 강조색 */
    font-size: 28px;
    margin-bottom: 25px;
    text-shadow: 0 0 5px rgba(140, 126, 255, 0.5);
  }
  .card {
    background: #1e1430; /* 카드 배경색 */
    padding: 25px;
    border-radius: 18px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.6), inset 0 0 8px rgba(140, 126, 255, 0.1);
    border: 1px solid #8c7eff33;
  }
  label {
    display: block;
    margin-top: 15px;
    margin-bottom: 5px;
    font-weight: bold;
    color: #c9d2e0;
    font-size: 15px;
  }
  input[type="number"],
  .date-select-group select,
  select:not(#hash) { /* RAM 해시레이트 선택 박스 제외 */
    max-width: 200px; /* 너비 제한 */
    width: 100%; /* 반응형을 위해 기본 100% 설정 후 max-width 적용 */
    padding: 12px 15px;
    margin-top: 5px;
    border: 1px solid #8c7eff55;
    border-radius: 10px;
    background: #120c24;
    color: #e0e6f0;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
    box-sizing: border-box;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
  }
  /* RAM 계산기 해시레이트 선택 박스 */
  select#hash {
    width: 100%;
    padding: 12px 15px;
    margin-top: 5px;
    border: 1px solid #8c7eff55;
    border-radius: 10px;
    background: #120c24;
    color: #e0e6f0;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
    box-sizing: border-box;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url('data:image/svg+xml;utf8,<svg fill="%23e0e6f0" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
    background-repeat: no-repeat;
    background-position: right 8px top 50%;
    background-size: 16px;
  }
  input::placeholder {
    color: #8a96a8;
  }
  button {
    margin-top: 30px;
    width: 100%;
    padding: 16px;
    background: linear-gradient(45deg, #8c7eff, #6a4ef7);
    color: white;
    font-size: 18px;
    font-weight: bold;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(140, 126, 255, 0.4);
  }
  button:hover {
    opacity: 0.95;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(140, 126, 255, 0.6);
  }
  #resultRam, #resultCpi { /* 각 계산기 결과 섹션 ID */
    margin-top: 30px;
  }
  .result-section {
    margin-bottom: 20px;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  .result-title {
    font-weight: bold;
    font-size: 18px;
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    color: #5effc9; /* 결과 타이틀 강조색 */
  }
  .result-item {
    margin: 8px 0;
    color: #d8e0e8;
    font-size: 16px;
  }
  .highlight {
    font-weight: bold;
    font-size: 17px;
    color: #5effc9; /* 강조 색상 (민트 계열) */
    text-shadow: 0 0 3px rgba(94, 255, 201, 0.5);
  }
  .main-box {background:#1f1636; border:1px solid #4e8ef7; color:#d8e0e8;}
  .bonus-box {background:#2a1b42; border:1px solid #8c63ff; color:#d8e0e8;}
  .total-box {background:#202a3a; border:1px solid #2fd4b5; color:#d8e0e8;}
  
  .main-box .result-title { color: #4e8ef7; }
  .bonus-box .result-title { color: #8c63ff; }
  .total-box .result-title { color: #2fd4b5; }

  .alert-box {
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 10px;
    font-weight: bold;
    text-align: center;
    font-size: 16px;
  }
  .alert-warning {
    background: #3a1a1a;
    color: #ff6b6b;
    border: 1px solid #ff4d4d;
  }
  .promo-group {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
    text-align: center;
    gap: 15px;
  }
  .promo-option {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #120c24;
    padding: 12px 0;
    border: 1px solid #6c63ff55;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
  }
  .promo-option input[type="radio"] {
    display: none; /* 라디오 버튼 자체를 숨김 */
  }
  .promo-option span {
    color: #ecf0f1;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 0;
  }
  .promo-option:has(input:checked) {
    background: linear-gradient(45deg, #6c63ff20, #4e8ef720);
    border-color: #6c63ff;
    box-shadow: 0 0 10px rgba(108, 99, 255, 0.5), inset 0 0 5px rgba(108, 99, 255, 0.3);
  }

  /* 날짜 드롭다운을 위한 스타일 */
  .date-select-group {
    display: flex;
    gap: 10px;
    margin-top: 5px;
  }
  .date-select-group select {
    flex: 1;
  }

  /* ✅ 탭 관련 스타일 */
  .tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 25px;
    background: #1e1430;
    border-radius: 18px;
    padding: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  }
  .tab-button {
    flex: 1;
    padding: 12px 0;
    text-align: center;
    background: none;
    border: none;
    color: #c9d2e0;
    font-size: 17px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 12px;
    transition: all 0.3s ease;
  }
  .tab-button.active {
    background: linear-gradient(45deg, #8c7eff, #6a4ef7);
    color: white;
    box-shadow: 0 3px 10px rgba(140, 126, 255, 0.4);
  }
  .tab-content {
    display: none; /* 기본적으로 숨김 */
  }
  .tab-content.active {
    display: block; /* 활성화된 탭만 보임 */
  }

  /* 반응형 디자인 */
  @media (max-width: 480px) {
    body {
      margin: 15px auto;
      padding: 15px;
    }
    .card {
      padding: 18px;
    }
    h2 {
      font-size: 24px;
    }
    button {
      font-size: 16px;
      padding: 12px;
    }
    .result-section {
      padding: 15px;
    }
    .result-title {
      font-size: 16px;
    }
    .result-item, .highlight {
      font-size: 14px;
    }
    .date-select-group {
      flex-direction: column;
    }
    input[type="number"],
    .date-select-group select {
      max-width: 100%;
    }
    .tabs {
      flex-direction: column; /* 탭도 모바일에서 세로로 정렬 */
      gap: 10px;
    }
    .tab-button {
      width: 100%;
    }
  }
</style>
</head>
<body>
<div class="card">
  <div class="tabs">
    <button class="tab-button active" data-tab="ram">RAM 계산기</button>
    <button class="tab-button" data-tab="cpi">CPI 계산기</button>
  </div>

  <div id="ramCalculator" class="tab-content active">
    <h2>RAM 요율 계산기</h2>

    <label>할당 금액(USDT):</label>
    <input type="number" id="invest" placeholder="예: 5000">

    <label>할당 기간(일):</label>
    <input type="number" id="days" placeholder="예: 120">

    <label>스테이킹 시작일 (2025년):</label>
    <div class="date-select-group">
      <select id="ramStartMonth"></select> <select id="ramStartDay"></select> </div>

    <label>해시레이트 구간:</label>
    <select id="hash">
      <option value="1">1M ~ 5M</option>
      <option value="1.05">5M ~ 8M</option>
      <option value="1.1025">8M ~ 16M</option>
      <option value="1.157625">16M ~ 25M</option>
      <option value="1.21550625">25M ~ 50M</option>
      <option value="1.27628157">50M+</option>
    </select>

    <label>프로모션 여부:</label>
    <div class="promo-group">
      <label class="promo-option">
        <span>기본</span>
        <input type="radio" name="promoRam" value="basic" checked style="display:none;"> </label>
      <label class="promo-option">
        <span>프로모션</span>
        <input type="radio" name="promoRam" value="promo" style="display:none;"> </label>
    </div>

    <button onclick="calculateRam()">계산하기</button> <div id="resultRam"></div> </div>

  <div id="cpiCalculator" class="tab-content">
    <h2>Sollong CPI 성장 계산기</h2>

    <label>초기 CPI 투자 금액(USDT):</label>
    <input type="number" id="initialInvest" placeholder="예: 5000">

    <label>CPI 스테이킹 시작일 (2025년):</label>
    <div class="date-select-group">
      <select id="cpiStartMonth"></select> <select id="cpiStartDay"></select> </div>

    <button onclick="calculateCpiGrowth()">계산하기</button>
    <div id="resultCpi"></div> </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  // 탭 기능 구현
  const tabButtons = document.querySelectorAll('.tab-button');
  const tabContents = document.querySelectorAll('.tab-content');

  tabButtons.forEach(button => {
    button.addEventListener('click', () => {
      // 모든 탭 버튼에서 active 클래스 제거
      tabButtons.forEach(btn => btn.classList.remove('active'));
      // 클릭된 버튼에 active 클래스 추가
      button.classList.add('active');

      // 모든 탭 콘텐츠 숨기기
      tabContents.forEach(content => content.classList.remove('active'));
      // 클릭된 탭에 해당하는 콘텐츠 보이기
      const targetTab = button.dataset.tab;
      document.getElementById(targetTab + 'Calculator').classList.add('active');
    });
  });


  // ==========================================================
  // RAM 계산기 로직
  // ==========================================================
  const ramStartMonthSelect = document.getElementById("ramStartMonth");
  const ramStartDaySelect = document.getElementById("ramStartDay");

  // RAM 계산기용 월/일 드롭다운 채우기
  function populateRamDays(month, year) {
    ramStartDaySelect.innerHTML = '';
    const daysInMonth = new Date(year, month, 0).getDate();
    for (let i = 1; i <= daysInMonth; i++) {
      const option = document.createElement("option");
      option.value = i.toString().padStart(2, '0');
      option.textContent = i + "일";
      ramStartDaySelect.appendChild(option);
    }
  }
  for (let i = 1; i <= 12; i++) {
    const option = document.createElement("option");
    option.value = i.toString().padStart(2, '0');
    option.textContent = i + "월";
    ramStartMonthSelect.appendChild(option);
  }
  ramStartMonthSelect.addEventListener("change", function() {
    const selectedMonth = parseInt(this.value);
    populateRamDays(selectedMonth, 2025);
  });
  const todayRam = new Date(); // RAM 계산기용 오늘 날짜
  const currentRamMonth = todayRam.getMonth() + 1;
  const currentRamDay = todayRam.getDate();
  ramStartMonthSelect.value = currentRamMonth.toString().padStart(2, '0');
  populateRamDays(currentRamMonth, 2025);
  ramStartDaySelect.value = currentRamDay.toString().padStart(2, '0');


  const dayBonusTable = [
    {day:81, bonus:1.00}, {day:161, bonus:1.01}, {day:240, bonus:1.02},
    {day:320, bonus:1.03}, {day:401, bonus:1.04}, {day:480, bonus:1.05},
    {day:561, bonus:1.06}, {day:641, bonus:1.07}, {day:720, bonus:1.08},
    {day:801, bonus:1.09}, {day:881, bonus:1.10}, {day:960, bonus:1.11},
    {day:1041, bonus:1.12}, {day:1121, bonus:1.13}, {day:1200, bonus:1.14},
    {day:1281, bonus:1.15}, {day:1361, bonus:1.16}, {day:1440, bonus:1.17},
    {day:1521, bonus:1.18}, {day:1601, bonus:1.19}, {day:1680, bonus:1.20},
    {day:1761, bonus:1.21}, {day:1841, bonus:1.22}, {day:1920, bonus:1.23},
    {day:2001, bonus:1.24}, {day:2081, bonus:1.25}, {day:2160, bonus:1.26},
    {day:2241, bonus:1.27}, {day:2320, bonus:1.28}, {day:2399, bonus:1.29},
    {day:2400, bonus:1.30}
  ];

  function getDayBonus(days) {
    let bonus = 1;
    for (let i = 0; i < dayBonusTable.length; i++) {
      if (days < dayBonusTable[i].day) break;
      bonus = dayBonusTable[i].bonus;
    }
    return bonus;
  }

  function getBaseRate(invest, promo) {
    if (promo === "promo") {
      if (invest < 1000) return 0.0050;
      if (invest < 5000) return 0.0053;
      if (invest < 10000) return 0.00578;
      return 0.00693;
    } else {
      if (invest < 1000) return 0.0050;
      if (invest < 5000) return 0.0053;
      if (invest < 10000) return 0.0055;
      return 0.0063;
    }
  }

  function getBonusRAM(invest, days) {
    if (days < 120) return 0;
    if (invest < 1000) return 0;
    if (invest < 5000) return invest * 0.10;
    if (invest < 10000) return invest * 0.15;
    return invest * 0.20;
  }

  function getBonusRate(bonusRAM) {
    if (bonusRAM === 0) return 0;
    if (bonusRAM < 1000) return 0.0050;
    if (bonusRAM < 5000) return 0.0053;
    if (bonusRAM < 10000) return 0.0055;
    return 0.0063;
  }

  window.calculateRam = function() { // 함수명 변경
    let invest = parseFloat(document.getElementById("invest").value);
    let days = parseInt(document.getElementById("days").value);
    
    const selectedMonth = document.getElementById("ramStartMonth").value; // ID 변경
    const selectedDay = document.getElementById("ramStartDay").value;     // ID 변경
    const startDateStr = `2025-${selectedMonth}-${selectedDay}`; // 2025년 고정
    
    let hashBonus = parseFloat(document.getElementById("hash").value);
    let promo = document.querySelector('input[name="promoRam"]:checked').value; // name 변경

    if (isNaN(invest) || isNaN(days) || !selectedMonth || !selectedDay) {
      document.getElementById("resultRam").innerHTML = "<div class='alert-box alert-warning'>모든 값을 입력하세요!</div>"; // ID 변경
      return;
    }

    let today = new Date();
    let start = new Date(startDateStr);
    
    if (isNaN(start.getTime())) {
        document.getElementById("resultRam").innerHTML = "<div class='alert-box alert-warning'>유효하지 않은 스테이킹 시작일입니다!</div>"; // ID 변경
        return;
    }

    let diffDays = Math.floor((today - start) / (1000 * 60 * 60 * 24));
    if (diffDays < 0) diffDays = 0;
    let remainDays = days - diffDays;
    if (remainDays < 0) remainDays = 0;

    let baseRate = getBaseRate(invest, promo);
    let dayBonus = getDayBonus(days);
    let dailyInterest_main = invest * baseRate * hashBonus * dayBonus;
    let total_main = dailyInterest_main * days;
    let recoveryDays_main = invest / dailyInterest_main;

    let bonusRAM = getBonusRAM(invest, days);
    let bonusRate = getBonusRate(bonusRAM);
    let dailyInterest_bonus = bonusRAM * bonusRate * hashBonus * 1.3;
    
    let bonus_interest_until_maturity = dailyInterest_bonus * days; 
    let bonus_interest_remaining = dailyInterest_bonus * (2400 - days);

    let total_until_maturity_combined = total_main + bonus_interest_until_maturity; 
    
    let total_main_received_so_far = dailyInterest_main * diffDays;
    let total_main_remaining_until_maturity = dailyInterest_main * remainDays;

    let total_bonus_received_so_far = dailyInterest_bonus * diffDays;
    let total_bonus_remaining_until_maturity = dailyInterest_bonus * remainDays;

    let total_combined_received_so_far = total_main_received_so_far + total_bonus_received_so_far;
    let total_combined_remaining_until_maturity = total_main_remaining_until_maturity + total_bonus_remaining_until_maturity;

    let recoveryDays_total = invest / (dailyInterest_main + dailyInterest_bonus);

    let alertMsg = (recoveryDays_main > days)
      ? "<div class='alert-box alert-warning'>🔔 알림: 만기 일이 원금 회수 기간보다 짧습니다.</div>"
      : "<div class='alert-box alert-success'>✅ 원금 회수가 가능합니다.</div>";

    let dailyWeeklyMonthlyDisplay = "";
    if (remainDays > 0) {
        let daily_total_for_remaining = dailyInterest_main + dailyInterest_bonus;
        dailyWeeklyMonthlyDisplay += "<div class='result-item'>만기일까지 받을 1일 이자: <span class='highlight'>" + daily_total_for_remaining.toFixed(2) + "</span> USDT</div>";
        if (remainDays >= 7) {
            dailyWeeklyMonthlyDisplay += "<div class='result-item'>만기일까지 받을 1주일 이자(7일): <span class='highlight'>" + (daily_total_for_remaining * 7).toFixed(2) + "</span> USDT</div>";
        }
        if (remainDays >= 30) {
            dailyWeeklyMonthlyDisplay += "<div class='result-item'>만기일까지 받을 1달 이자(30일): <span class='highlight'>" + (daily_total_for_remaining * 30).toFixed(2) + "</span> USDT</div>";
        }
    }


    document.getElementById("resultRam").innerHTML = // ID 변경
      alertMsg +
      "<div class='result-section main-box'><div class='result-title'>[내가 구매한 RAM]</div>" +
      "<div class='result-item'>투자 금액: <span class='highlight'>" + invest.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>일일 이자: <span class='highlight'>" + dailyInterest_main.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>총 이자(" + days + "일): <span class='highlight'>" + total_main.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>원금 회수 예상일: <span class='highlight'>약 " + Math.ceil(recoveryDays_main) + " 일</span></div>" +
      "<div class='result-item'>현재까지 받은 총 이자: <span class='highlight'>" + total_main_received_so_far.toFixed(2) + "</span> USDT</div>" + 
      "<div class='result-item'>만기일 까지 남은 총 이자: <span class='highlight'>" + total_main_remaining_until_maturity.toFixed(2) + "</span> USDT</div></div>" + 

      "<div class='result-section bonus-box'><div class='result-title'>[프로모션 보너스 RAM]</div>" +
      "<div class='result-item'>보너스 RAM: <span class='highlight'>" + bonusRAM.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>일일 이자: <span class='highlight'>" + dailyInterest_bonus.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>만기일까지 이자(" + days + "일): <span class='highlight'>" + bonus_interest_until_maturity.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>남은 기간 이자(" + Math.max(0, 2400 - days) + "일): <span class='highlight'>" + bonus_interest_remaining.toFixed(2) + "</span> USDT</div></div>" + 
      "<div class='result-item'>현재까지 받은 총 이자: <span class='highlight'>" + total_bonus_received_so_far.toFixed(2) + "</span> USDT</div>" + 
      "<div class='result-item'>만기일 까지 남은 총 이자: <span class='highlight'>" + total_bonus_remaining_until_maturity.toFixed(2) + "</span> USDT</div></div>" + 

      "<div class='result-section total-box'><div class='result-title'>[총 합계]</div>" +
      "<div class='result-item'>스테이킹 진행: <span class='highlight'>" + diffDays + "일 경과 / " + remainDays + "일 남음</span></div>" +
      "<div class='result-item'>현재까지 받은 총 이자(스테이킹+보너스): <span class='highlight'>" + total_combined_received_so_far.toFixed(2) + "</span> USDT</div>" + 
      "<div class='result-item'>만기일 까지 남은 총 이자(스테이킹+보너스): <span class='highlight'>" + total_combined_remaining_until_maturity.toFixed(2) + "</span> USDT</div>" + 
      "<div class='result-item'>만기일까지 받는 총 이자(스테이킹+보너스): <span class='highlight'>" + total_until_maturity_combined.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>원금 회수 예상(보너스 포함): <span class='highlight'>약 " + Math.ceil(recoveryDays_total) + " 일</span></div>" +
      dailyWeeklyMonthlyDisplay + 
      "</div>";
  };


  // ==========================================================
  // CPI 계산기 로직
  // ==========================================================
  const cpiStartMonthSelect = document.getElementById("cpiStartMonth");
  const cpiStartDaySelect = document.getElementById("cpiStartDay");

  // CPI 계산기용 월/일 드롭다운 채우기
  function populateCpiDays(month, year) {
    cpiStartDaySelect.innerHTML = '';
    const daysInMonth = new Date(year, month, 0).getDate();
    for (let i = 1; i <= daysInMonth; i++) {
      const option = document.createElement("option");
      option.value = i.toString().padStart(2, '0');
      option.textContent = i + "일";
      cpiStartDaySelect.appendChild(option);
    }
  }
  for (let i = 1; i <= 12; i++) {
    const option = document.createElement("option");
    option.value = i.toString().padStart(2, '0');
    option.textContent = i + "월";
    cpiStartMonthSelect.appendChild(option);
  }
  cpiStartMonthSelect.addEventListener("change", function() {
    const selectedMonth = parseInt(this.value);
    populateCpiDays(selectedMonth, 2025);
  });
  const todayCpi = new Date(); // CPI 계산기용 오늘 날짜
  const currentCpiMonth = todayCpi.getMonth() + 1;
  const currentCpiDay = todayCpi.getDate();
  cpiStartMonthSelect.value = currentCpiMonth.toString().padStart(2, '0');
  populateCpiDays(currentCpiMonth, 2025);
  cpiStartDaySelect.value = currentCpiDay.toString().padStart(2, '0');


  window.calculateCpiGrowth = function() {
    let initialInvest = parseFloat(document.getElementById("initialInvest").value);
    const selectedMonth = document.getElementById("cpiStartMonth").value;
    const selectedDay = document.getElementById("cpiStartDay").value;
    const startDateStr = `2025-${selectedMonth}-${selectedDay}`;

    if (isNaN(initialInvest) || initialInvest <= 0 || !selectedMonth || !selectedDay) {
        document.getElementById("resultCpi").innerHTML = "<div class='alert-box alert-warning'>초기 투자 금액과 스테이킹 시작일을 올바르게 입력해주세요!</div>";
        return;
    }

    const dailyYieldRate = 0.01; // 일일 1% 해제율율
    const reinvestCycleDays = 7; // 재투자 주기 7일
    const minReinvestAmount = 50; // 최소 재투자 금액 50 USDT

    let currentCpiTotal = initialInvest;
    let totalGeneratedInterest = 0;
    let totalReinvestedAmount = 0;
    let totalReinvestmentCount = 0;
    let accumulatedInterestForReinvest = 0;

    let target2x = initialInvest * 2;
    let target3x = initialInvest * 3;
    let target4x = initialInvest * 4;

    let daysTo2x = "미달성";
    let daysTo3x = "미달성";
    let daysTo4x = "미달성";
    let maxSimulationDays = 365 * 2; // 최대 2년 시뮬레이션 (너무 길어지는 것 방지)

    const todayDate = new Date();
    const startDate = new Date(startDateStr);
    if (isNaN(startDate.getTime())) {
        document.getElementById("resultCpi").innerHTML = "<div class='alert-box alert-warning'>유효하지 않은 스테이킹 시작일입니다!</div>";
        return;
    }
    const daysPassedSinceStart = Math.floor((todayDate - startDate) / (1000 * 60 * 60 * 24));
    
    let daysSimulated = 0; // 시뮬레이션을 시작한 날부터의 경과 일수 (2x, 3x, 4x 계산용)

    while (currentCpiTotal < target4x && daysSimulated < maxSimulationDays) {
        daysSimulated++; // 하루 경과

        let dailyInterest = currentCpiTotal * dailyYieldRate;
        totalGeneratedInterest += dailyInterest;
        accumulatedInterestForReinvest += dailyInterest;

        if ((daysSimulated % reinvestCycleDays === 0) && (accumulatedInterestForReinvest >= minReinvestAmount)) {
            currentCpiTotal += accumulatedInterestForReinvest;
            totalReinvestedAmount += accumulatedInterestForReinvest;
            totalReinvestmentCount++;
            accumulatedInterestForReinvest = 0;
        }

        if (daysTo2x === "미달성" && currentCpiTotal >= target2x) {
            daysTo2x = daysSimulated;
        }
        if (daysTo3x === "미달성" && currentCpiTotal >= target3x) {
            daysTo3x = daysSimulated;
        }
        if (daysTo4x === "미달성" && currentCpiTotal >= target4x) {
            daysTo4x = daysSimulated;
        }
    }
    
    // 현재 스테이킹 정보 계산 (사용자가 설정한 시작일부터 현재까지)
    let currentCpiAtToday = initialInvest;
    let currentAccumulatedInterestForReinvest = 0;
    let todayReinvestCount = 0;
    let todayReinvestedAmount = 0;

    for (let day = 1; day <= daysPassedSinceStart; day++) {
        let dailyInterest = currentCpiAtToday * dailyYieldRate;
        currentAccumulatedInterestForReinvest += dailyInterest;

        if ((day % reinvestCycleDays === 0) && (currentAccumulatedInterestForReinvest >= minReinvestAmount)) {
            currentCpiAtToday += currentAccumulatedInterestForReinvest;
            todayReinvestedAmount += currentAccumulatedInterestForReinvest;
            todayReinvestCount++;
            currentAccumulatedInterestForReinvest = 0;
        }
    }

    // 다음 재투자까지 남은 일수 계산
    let daysToNextReinvestCycle = reinvestCycleDays - (daysPassedSinceStart % reinvestCycleDays);
    if (daysToNextReinvestCycle === reinvestCycleDays) {
        daysToNextReinvestCycle = 7;
    }
    if (daysPassedSinceStart < 0) { // 스테이킹 시작일이 미래일 경우
        daysToNextReinvestCycle = 7;
    }


    document.getElementById("resultCpi").innerHTML = // ID 변경
      "<div class='result-section'>" +
      "<div class='result-title'>CPI 성장 목표 달성 시점 예측</div>" +
      "<div class='result-item'>초기 투자 금액: <span class='highlight'>" + initialInvest.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>CPI 2배 달성 시점: <span class='highlight'>" + daysTo2x + "</span> 일차</div>" +
      "<div class='result-item'>CPI 3배 달성 시점: <span class='highlight'>" + daysTo3x + "</span> 일차</div>" +
      "<div class='result-item'>CPI 4배 달성 시점: <span class='highlight'>" + daysTo4x + "</span> 일차</div>" +
      "</div>" +
      "<div class='result-section'>" +
      "<div class='result-title'>현재 스테이킹 정보</div>" +
      "<div class='result-item'>스테이킹 시작일로부터: <span class='highlight'>" + daysPassedSinceStart + "</span> 일 경과</div>" +
      "<div class='result-item'>현재 총 CPI : <span class='highlight'>" + currentCpiAtToday.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>현재까지 재투자된 금액: <span class='highlight'>" + todayReinvestedAmount.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>현재까지 재투자 횟수: <span class='highlight'>" + todayReinvestCount + "</span> 회</div>" +
      "<div class='result-item'>다음 재투자까지: <span class='highlight'>" + daysToNextReinvestCycle + "</span> 일 남음</div>" +
      "</div>" +
      "<div class='result-section'>" +
      "<div class='result-title'>총 시뮬레이션 요약 (" + daysSimulated + "일 기준)</div>" +
      "<div class='result-item'>현재 총 CPI : <span class='highlight'>" + currentCpiTotal.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>총 CPI 해제량 (누적): <span class='highlight'>" + totalGeneratedInterest.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>총 재투자된 CPI 배포: <span class='highlight'>" + totalReinvestedAmount.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>총 재투자 횟수: <span class='highlight'>" + totalReinvestmentCount + "</span> 회</div>" +
      "</div>";
  };
});
</script>
</body>
</html>
