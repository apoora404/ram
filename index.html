<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>RAM 요율 계산기</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 30px auto;
    padding: 20px;
    background: #0f111a;
    color: #ecf0f1;
  }
  h2 {
    text-align: center;
    color: #6c63ff;
    font-size: 26px;
    margin-bottom: 20px;
  }
  .card {
    background: #1a1a2e;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    border: 1px solid #6c63ff33;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
    color: #cfd3e0;
  }
  input, select {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border: 1px solid #6c63ff55;
    border-radius: 8px;
    background: #12141f;
    color: #fff;
  }
  input::placeholder {
    color: #888;
  }
  button {
    margin-top: 20px;
    width: 100%;
    padding: 14px;
    background: linear-gradient(45deg, #6c63ff, #4e8ef7);
    color: white;
    font-size: 16px;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.3s;
  }
  button:hover {
    opacity: 0.9;
  }
  #result {
    margin-top: 25px;
  }
  .result-section {
    margin-bottom: 18px;
    padding: 15px;
    border-radius: 8px;
  }
  .result-title {
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 5px;
  }
  .result-item {
    margin: 4px 0;
    color: #ecf0f1;
    font-size: 15px;
  }
  .highlight {
    font-weight: bold;
    font-size: 15px;
    color: #4e8ef7;
  }
  .main-box {background:#12141f; border:1px solid #4e8ef7;}
  .bonus-box {background:#17162a; border:1px solid #8c63ff;}
  .total-box {background:#132428; border:1px solid #2fd4b5;}
  .alert-box {
    padding: 12px;
    margin-bottom: 15px;
    border-radius: 6px;
    font-weight: bold;
    text-align: center;
  }
  .alert-success {
    background: #132428;
    color: #2fd4b5;
    border: 1px solid #2fd4b5;
  }
  .alert-warning {
    background: #2a1313;
    color: #ff4d4d;
    border: 1px solid #ff4d4d;
  }
  .promo-group {
    display: flex;
    justify-content: space-between;
    margin-top: 5px;
    text-align: center;
  }
  .promo-option {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 45%;
    background: #12141f;
    padding: 10px 0;
    border: 1px solid #6c63ff55;
    border-radius: 8px;
  }
  .promo-option span {
    color: #ecf0f1;
    font-size: 15px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 5px;
  }
  /* 날짜 드롭다운을 위한 스타일 */
  .date-select-group {
    display: flex;
    gap: 10px; /* 드롭다운 간격 */
    margin-top: 5px;
  }
  .date-select-group select {
    flex: 1; /* 너비를 동일하게 분배 */
  }
</style>
</head>
<body>
<div class="card">
<h2>RAM 요율 계산기</h2>

<label>할당 금액(USDT):</label>
<input type="number" id="invest" placeholder="예: 5000">

<label>할당 기간(일):</label>
<input type="number" id="days" placeholder="예: 120">

<label>예치 시작일 (2025년):</label>
<div class="date-select-group">
  <select id="startMonth"></select>
  <select id="startDay"></select>
</div>

<label>해시레이트 구간:</label>
<select id="hash">
  <option value="1">1M ~ 5M</option>
  <option value="1.05">5M ~ 8M</option>
  <option value="1.1025">8M ~ 16M</option>
  <option value="1.157625">16M ~ 25M</option>
  <option value="1.21550625">25M ~ 50M</option>
  <option value="1.27628157">50M+</option>
</select>

<label>프로모션 여부:</label>
<div class="promo-group">
  <div class="promo-option">
    <span>기본</span>
    <input type="radio" name="promo" value="basic" checked>
  </div>
  <div class="promo-option">
    <span>프로모션</span>
    <input type="radio" name="promo" value="promo">
  </div>
</div>

<button onclick="calc()">계산하기</button>
<div id="result"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const startMonthSelect = document.getElementById("startMonth");
  const startDaySelect = document.getElementById("startDay");

  // 월 드롭다운 채우기 (1월 ~ 12월)
  for (let i = 1; i <= 12; i++) {
    const option = document.createElement("option");
    option.value = i.toString().padStart(2, '0'); // '01', '02' 형식
    option.textContent = i + "월";
    startMonthSelect.appendChild(option);
  }

  // 일 드롭다운 채우기 (선택된 월에 따라 동적으로 변경)
  function populateDays(month, year) {
    startDaySelect.innerHTML = ''; // 기존 옵션 모두 제거
    const daysInMonth = new Date(year, month, 0).getDate(); // 해당 월의 마지막 일자 계산 (예: 2025년 2월은 28일)
    for (let i = 1; i <= daysInMonth; i++) {
      const option = document.createElement("option");
      option.value = i.toString().padStart(2, '0'); // '01', '02' 형식
      option.textContent = i + "일";
      startDaySelect.appendChild(option);
    }
  }

  // 월 선택 변경 시 일 드롭다운 업데이트
  startMonthSelect.addEventListener("change", function() {
    const selectedMonth = parseInt(this.value);
    populateDays(selectedMonth, 2025); // 2025년 고정
  });

  // 초기 로드 시 오늘 날짜로 월/일 설정
  const today = new Date();
  const currentMonth = today.getMonth() + 1; // getMonth()는 0부터 시작
  const currentDay = today.getDate();
  
  startMonthSelect.value = currentMonth.toString().padStart(2, '0');
  populateDays(currentMonth, 2025); // 현재 월 기준으로 일자 채우기
  startDaySelect.value = currentDay.toString().padStart(2, '0');

  // ✅ 계산 로직
  const dayBonusTable = [
    {day:81, bonus:1.00}, {day:161, bonus:1.01}, {day:240, bonus:1.02},
    {day:320, bonus:1.03}, {day:401, bonus:1.04}, {day:480, bonus:1.05},
    {day:561, bonus:1.06}, {day:641, bonus:1.07}, {day:720, bonus:1.08},
    {day:801, bonus:1.09}, {day:881, bonus:1.10}, {day:960, bonus:1.11},
    {day:1041, bonus:1.12}, {day:1121, bonus:1.13}, {day:1200, bonus:1.14},
    {day:1281, bonus:1.15}, {day:1361, bonus:1.16}, {day:1440, bonus:1.17},
    {day:1521, bonus:1.18}, {day:1601, bonus:1.19}, {day:1680, bonus:1.20},
    {day:1761, bonus:1.21}, {day:1841, bonus:1.22}, {day:1920, bonus:1.23},
    {day:2001, bonus:1.24}, {day:2081, bonus:1.25}, {day:2160, bonus:1.26},
    {day:2241, bonus:1.27}, {day:2320, bonus:1.28}, {day:2399, bonus:1.29},
    {day:2400, bonus:1.30}
  ];

  function getDayBonus(days) {
    let bonus = 1;
    for (let i = 0; i < dayBonusTable.length; i++) {
      if (days < dayBonusTable[i].day) break;
      bonus = dayBonusTable[i].bonus;
    }
    return bonus;
  }

  function getBaseRate(invest, promo) {
    if (promo === "promo") {
      if (invest < 1000) return 0.0050;
      if (invest < 5000) return 0.0053;
      if (invest < 10000) return 0.00578;
      return 0.00693;
    } else {
      if (invest < 1000) return 0.0050;
      if (invest < 5000) return 0.0053;
      if (invest < 10000) return 0.0055;
      return 0.0063;
    }
  }

  function getBonusRAM(invest, days) {
    if (days < 120) return 0;
    if (invest < 1000) return 0;
    if (invest < 5000) return invest * 0.10;
    if (invest < 10000) return invest * 0.15;
    return invest * 0.20;
  }

  function getBonusRate(bonusRAM) {
    if (bonusRAM === 0) return 0;
    if (bonusRAM < 1000) return 0.0050;
    if (bonusRAM < 5000) return 0.0053;
    if (bonusRAM < 10000) return 0.0055;
    return 0.0063;
  }

  window.calc = function() { // calc 함수를 전역으로 노출
    let invest = parseFloat(document.getElementById("invest").value);
    let days = parseInt(document.getElementById("days").value);
    
    // 월/일 드롭다운에서 값 가져와 startDate 문자열 생성
    const selectedMonth = document.getElementById("startMonth").value;
    const selectedDay = document.getElementById("startDay").value;
    const startDate = `2025-${selectedMonth}-${selectedDay}`; // 2025년 고정
    
    let hashBonus = parseFloat(document.getElementById("hash").value);
    let promo = document.querySelector('input[name="promo"]:checked').value;

    if (isNaN(invest) || isNaN(days) || !selectedMonth || !selectedDay) {
      document.getElementById("result").innerHTML = "<div class='alert-box alert-warning'>모든 값을 입력하세요!</div>";
      return;
    }

    let today = new Date();
    let start = new Date(startDate);
    
    // 유효하지 않은 날짜 처리
    if (isNaN(start.getTime())) {
        document.getElementById("result").innerHTML = "<div class='alert-box alert-warning'>유효하지 않은 예치 시작일입니다!</div>";
        return;
    }

    let diffDays = Math.floor((today - start) / (1000 * 60 * 60 * 24));
    if (diffDays < 0) diffDays = 0;
    let remainDays = days - diffDays;
    if (remainDays < 0) remainDays = 0;

    let baseRate = getBaseRate(invest, promo);
    let dayBonus = getDayBonus(days);
    let dailyInterest_main = invest * baseRate * hashBonus * dayBonus;
    let total_main = dailyInterest_main * days;
    let recoveryDays_main = invest / dailyInterest_main;

    let bonusRAM = getBonusRAM(invest, days);
    let bonusRate = getBonusRate(bonusRAM);
    let dailyInterest_bonus = bonusRAM * bonusRate * hashBonus * 1.3;
    
    // 만기일까지의 보너스 이자만 합산
    let bonus_interest_until_maturity = dailyInterest_bonus * days; 
    let bonus_interest_remaining = dailyInterest_bonus * (2400 - days);

    // 총합 (만기일까지 받은 총 이자)
    let total_until_maturity_combined = total_main + bonus_interest_until_maturity; 
    
    // ✅ 1일/1주일/1달 이자 (앞으로 수령할 수 있는 이자)
    let dailyInterestDisplay = "";
    if (remainDays > 0) { // 만기일이 아직 남은 경우: 예치+보너스 이자 모두 수령
        let daily_total_receivable = dailyInterest_main + dailyInterest_bonus; 
        dailyInterestDisplay = "<div class='result-item'>앞으로 받을 1일 총 이자: <span class='highlight'>" + daily_total_receivable.toFixed(2) + "</span> USDT</div>" +
                               "<div class='result-item'>앞으로 받을 1주일 총 이자(7일): <span class='highlight'>" + (daily_total_receivable * 7).toFixed(2) + "</span> USDT</div>" +
                               "<div class='result-item'>앞으로 받을 1달 총 이자(30일): <span class='highlight'>" + (daily_total_receivable * 30).toFixed(2) + "</span> USDT</div>";
    } else { // 만기일이 도래했거나 지난 경우: 보너스 RAM 이자만 수령
        dailyInterestDisplay = "<div class='result-item'>앞으로 받을 1일 보너스 RAM 이자: <span class='highlight'>" + dailyInterest_bonus.toFixed(2) + "</span> USDT</div>" +
                               "<div class='result-item'>앞으로 받을 1주일 보너스 RAM 이자(7일): <span class='highlight'>" + (dailyInterest_bonus * 7).toFixed(2) + "</span> USDT</div>" +
                               "<div class='result-item'>앞으로 받을 1달 보너스 RAM 이자(30일): <span class='highlight'>" + (dailyInterest_bonus * 30).toFixed(2) + "</span> USDT</div>";
    }

    // 원금 회수 예상 (보너스 포함)은 여전히 일일 총 이자 기준
    let recoveryDays_total = invest / (dailyInterest_main + dailyInterest_bonus);


    let alertMsg = (recoveryDays_main > days)
      ? "<div class='alert-box alert-warning'>🔔 알림: 만기 일이 원금 회수 기간보다 짧습니다.</div>"
      : "<div class='alert-box alert-success'>✅ 원금 회수가 가능합니다.</div>";

    document.getElementById("result").innerHTML =
      alertMsg +
      "<div class='result-section main-box'><div class='result-title'>[내가 구매한 RAM]</div>" +
      "<div class='result-item'>투자 금액: <span class='highlight'>" + invest.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>일일 이자: <span class='highlight'>" + dailyInterest_main.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>총 이자(" + days + "일): <span class='highlight'>" + total_main.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>원금 회수 예상일: <span class='highlight'>약 " + Math.ceil(recoveryDays_main) + " 일</span></div></div>" +

      "<div class='result-section bonus-box'><div class='result-title'>[프로모션 보너스 RAM]</div>" +
      "<div class='result-item'>보너스 RAM: <span class='highlight'>" + bonusRAM.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>일일 이자: <span class='highlight'>" + dailyInterest_bonus.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>만기일까지 이자(" + days + "일): <span class='highlight'>" + bonus_interest_until_maturity.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>남은 기간 이자(" + Math.max(0, 2400 - days) + "일): <span class='highlight'>" + bonus_interest_remaining.toFixed(2) + "</span> USDT</div></div>" +

      "<div class='result-section total-box'><div class='result-title'>[총 합계]</div>" +
      "<div class='result-item'>예치 진행: <span class='highlight'>" + diffDays + "일 경과 / " + remainDays + "일 남음</span></div>" +
      "<div class='result-item'>만기일까지 받은 총 이자(예치+보너스): <span class='highlight'>" + total_until_maturity_combined.toFixed(2) + "</span> USDT</div>" +
      "<div class='result-item'>원금 회수 예상(보너스 포함): <span class='highlight'>약 " + Math.ceil(recoveryDays_total) + " 일</span></div>" +
      dailyInterestDisplay + // 조건부로 생성된 1일/1주/1달 이자 표시
      "</div>";
  }
});
</script>
</body>
</html>
